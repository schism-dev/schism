
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-8.3.4">
    
    
      
        <title>Barotropic solver - SCHISM</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#general-formulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="SCHISM" class="md-header__button md-logo" aria-label="SCHISM" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SCHISM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Barotropic solver
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/schism-dev/schism" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="SCHISM" class="md-nav__button md-logo" aria-label="SCHISM" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    SCHISM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/schism-dev/schism" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog.html" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/getting-sourcecode.html" class="md-nav__link">
        Getting the source code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/compilation.html" class="md-nav__link">
        Compilation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/test_suite.html" class="md-nav__link">
        Test suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/typical-workflow.html" class="md-nav__link">
        Typical workflow (a cheat sheet)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/grid-generation.html" class="md-nav__link">
        Mesh generation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing.html" class="md-nav__link">
        Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_8" type="checkbox" id="__nav_3_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_8">
          Preprocessing with pylib
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Preprocessing with pylib" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Preprocessing with pylib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pylib/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pylib/installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pylib/schismcheck.html" class="md-nav__link">
        schismCheck (input visualization)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_9" type="checkbox" id="__nav_3_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_9">
          Preprocessing with PySCHISM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Preprocessing with PySCHISM" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          Preprocessing with PySCHISM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/bctides.html" class="md-nav__link">
        Tides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/boundary.html" class="md-nav__link">
        B.C. from HYCOM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/atmos.html" class="md-nav__link">
        Atmospheric forcing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/nwm.html" class="md-nav__link">
        Souce and Sink
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/running-model.html" class="md-nav__link">
        Running the model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/visualization.html" class="md-nav__link">
        Visualization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/post-processing.html" class="md-nav__link">
        Postprocessing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Model formulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model formulation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Model formulation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="physical-formulation.html" class="md-nav__link">
        Physical formulation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Numerical formulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Numerical formulation" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Numerical formulation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="geometry-discretization.html" class="md-nav__link">
        Geometry and discretization
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Barotropic solver
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="barotropic-solver.html" class="md-nav__link md-nav__link--active">
        Barotropic solver
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-formulation" class="md-nav__link">
    General formulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locally-2d-case" class="md-nav__link">
    Locally 2D case
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#locally-3d-case" class="md-nav__link">
    Locally 3D case
  </a>
  
    <nav class="md-nav" aria-label="Locally 3D case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#emergent-vegetation" class="md-nav__link">
    Emergent vegetation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submerged-vegetation" class="md-nav__link">
    Submerged vegetation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-case" class="md-nav__link">
    General case
  </a>
  
    <nav class="md-nav" aria-label="General case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integral-i_3" class="md-nav__link">
    Integral \(I_3\)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integral-i_5" class="md-nav__link">
    Integral \(I_5\)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integral-i_1" class="md-nav__link">
    Integral \(I_1\)
  </a>
  
    <nav class="md-nav" aria-label="Integral \(I_1\)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-i-triangle" class="md-nav__link">
    Case I: triangle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-ii-quad" class="md-nav__link">
    Case II: Quad
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integral-i_4" class="md-nav__link">
    Integral \(I_4\)
  </a>
  
    <nav class="md-nav" aria-label="Integral \(I_4\)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#baroclinicity" class="md-nav__link">
    Baroclinicity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#horizontal-viscosity" class="md-nav__link">
    Horizontal viscosity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="eulerian-lagrangian-method.html" class="md-nav__link">
        Eulerian-Lagrangian Method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="momentum-equation.html" class="md-nav__link">
        Momentum equation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="vertical-velocity.html" class="md-nav__link">
        Vertical velocity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="turbulence-closure.html" class="md-nav__link">
        Turbulence closure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="transport-equation.html" class="md-nav__link">
        Transport equation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="updating-levels.html" class="md-nav__link">
        Updating the levels/Inundation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="spherical-coordinates.html" class="md-nav__link">
        Spherical coordinates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Input/Output
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Input/Output" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Input/Output
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/hgrid.html" class="md-nav__link">
        Horizontal grid (hgrid.gr3)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/vgrid.html" class="md-nav__link">
        Vertical grid (vgrid.in)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/param.html" class="md-nav__link">
        Model parameters (param.nml)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/bctides.html" class="md-nav__link">
        Boundary conditions (bctides.in)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/friction.html" class="md-nav__link">
        Bottom friction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/sflux.html" class="md-nav__link">
        Atmospheric flux (/sflux)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/optional-inputs.html" class="md-nav__link">
        Optional inputs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/outputs.html" class="md-nav__link">
        Outputs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Mesh generation - advanced topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mesh generation - advanced topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Mesh generation - advanced topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/cross_regime.html" class="md-nav__link">
        Meshing for cross-scale regimes
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Meshing for compound floods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Meshing for compound floods" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Meshing for compound floods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/extract-thalweg.html" class="md-nav__link">
        Extract thalwegs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/generate-river-map.html" class="md-nav__link">
        Generate river map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/meshing-in-SMS.html" class="md-nav__link">
        Meshing in SMS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/generic-tracer.html" class="md-nav__link">
        Generic tracer module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/age.html" class="md-nav__link">
        AGE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/sed2d.html" class="md-nav__link">
        2D Sediment model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/sed3d.html" class="md-nav__link">
        3D Sediment model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/icm.html" class="md-nav__link">
        ICM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/cosine.html" class="md-nav__link">
        CoSiNe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/dvd.html" class="md-nav__link">
        DVD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/marsh-migration.html" class="md-nav__link">
        Marsh migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/analysis-mode.html" class="md-nav__link">
        Analysis mode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/hydraulics.html" class="md-nav__link">
        Hydraulics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/particle-tracking.html" class="md-nav__link">
        Particle tracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/wwm.html" class="md-nav__link">
        WWM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/fabm.html" class="md-nav__link">
        FABM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/pahm.html" class="md-nav__link">
        PaHM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/single-class-ice.html" class="md-nav__link">
        Single-class ice module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../code-contribution.html" class="md-nav__link">
        Code structure
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../case-study.html" class="md-nav__link">
        Case studies
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          SCHISM external coupling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SCHISM external coupling" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          SCHISM external coupling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/esmf.html" class="md-nav__link">
        Earth System Modeling Framework
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/nuopc.html" class="md-nav__link">
        National Unified Operational Prediction Capability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/coastalapp.html" class="md-nav__link">
        NOAA's CoastalApp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/mossco.html" class="md-nav__link">
        Modular System for Shelves and Coasts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/cesm.html" class="md-nav__link">
        NCAR's Community Earth System Model
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq.html" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../known_issues.html" class="md-nav__link">
        Known issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute-to-this-online-manual.html" class="md-nav__link">
        Contribute to this online manual
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/schism-dev/schism/edit/master/docs/schism/barotropic-solver.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>Barotropic solver</h1>

<h2 id="general-formulation">General formulation<a class="headerlink" href="#general-formulation" title="Permanent link">&para;</a></h2>
<p>SCHISM solves the barotropic equations first (<a href="physical-formulation.html">Eqs 1-3</a>) first, as the transport and turbulent closure equations lag one time step behind (in other words, the baroclinic pressure gradient term in the momentum equation is treated explicitly in SCHISM). The transport and turbulent closure equations will be discussed later. Due to the hydrostatic approximation, the vertical velocity <span class="arithmatex">\(w\)</span> is solved from the 3D continuity equation after the horizontal velocity is found. To solve the coupled <a href="physical-formulation.html">Eqs. 1 and 3</a>, we first discretize them and the vertical boundary conditions semi-implicitly in time as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq01}
\frac{\eta^{n+1} - \eta^{n}}{\Delta t} + \theta \nabla \cdot \int_{-h}^{\eta} \pmb{u}^{n+1} dz + (1-\theta) \nabla \cdot \int_{-h}^{\eta} \pmb{u}^{n} dz = 0
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq02}
\frac{\pmb{u}^{n+1} - \pmb{u}^*}{\Delta t} = \pmb{f} - g \theta \nabla \eta^{n+1} - g(1-\theta)\nabla\eta^n + \pmb{m}_z^{n+1} - \alpha\left|\pmb{u}\right|\pmb{u}^{n+1} L(x, y, z)
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq03}
\begin{aligned}
\text{for 3D cells: }
    \begin{cases}
    \nu^n \frac{\partial \pmb{u}^{n+1}}{\partial z} = \pmb{\tau}_{w}^{n+1}, \text{ at } z=\eta^n\\
    \nu^n \frac{\partial \pmb{u}^{n+1}}{\partial z} = \chi^n \pmb{u}_{b}^{n+1}, \text{ at } z=-h
    \end{cases}
\end{aligned}
\end{equation}\]</div>
<p>where superscripts denote the time step, <span class="arithmatex">\(0 \leq \theta \leq 1\)</span> is the implicitness factor, <span class="arithmatex">\(\pmb{u}^*(x, y, z, t^n)\)</span> is the back-tracked value calculated with Eulerian-Lagrangian Method (ELM; <a href="eulerian-lagrangian-method.html">see here</a>), and <span class="arithmatex">\(\chi^n = C_D \left| \pmb{u}_{b}^{n} \right|\)</span>. The elevations in the 2nd and 3rd terms of Eq. <span class="arithmatex">\(\ref{eq01}\)</span> are treated explicitly, which effectively amounts to a linearization procedure.</p>
<p>A Galerkin weighted residual statement in the weak form for Eq. <span class="arithmatex">\(\ref{eq01}\)</span> reads: </p>
<div class="arithmatex">\[\begin{equation}
\label{eq04}
\int_\Omega \phi_i \frac{\eta^{n+1} - \eta^{n}}{\Delta t} d\Omega + \theta \left[ -\int_\Omega \nabla \phi_i \cdot \pmb{U}^{n+1} d\Omega + \int_\Gamma \phi_i U_n^{n+1} d\Gamma \right] + (1-\theta) \left[ -\int_\Omega \nabla \phi_i \cdot \pmb{U}^{n} d\Omega + \int_\Gamma \phi_i U_n^n d\Gamma \right] = 0, (i = 1, ... , N_p)
\end{equation}\]</div>
<p>Where <span class="arithmatex">\(N_p\)</span> is the total number of nodes, <span class="arithmatex">\(\Gamma \equiv \Gamma_\nu + \overline{\Gamma}_\nu\)</span> is the boundary of the entire domain <span class="arithmatex">\(\Omega\)</span>, with <span class="arithmatex">\(\Gamma_\nu\)</span> corresponding to the boundary sagments where natural boundary conditions are specified, <span class="arithmatex">\(\pmb{U} = \int_{-h}^{\eta} \pmb{u}dz\)</span> is the depth-integrated velocity, <span class="arithmatex">\(U_n\)</span> is its normal component along the boundary, and <span class="arithmatex">\(\hat{U}_n\)</span> is the boundary condition. In SCHISM, linear shape functions are used (area coordinates for triangles and bi-linear function for quads); thus, <span class="arithmatex">\(\phi_i\)</span> are familier "hat" functions.</p>
<h2 id="locally-2d-case">Locally 2D case<a class="headerlink" href="#locally-2d-case" title="Permanent link">&para;</a></h2>
<p>Since there is only one degree of freedom in the vertical dimention in this case, a straightforward integration of Eq. <span class="arithmatex">\(\ref{eq02}\)</span> gives - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq05}
\pmb{U}^{n+1} = \check{\pmb{G}} - g\theta\Delta t \frac{H^2}{\tilde{H}} \nabla \eta^{n+1}
\end{equation}\]</div>
<p>Where <span class="arithmatex">\(\check{\pmb{G}}\)</span> incorporates explicit term - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq06}
\check{\pmb{G}} = \frac{H}{\tilde{H}}\left[ \pmb{U}^* + \Delta t \left( \pmb{F} + \pmb{\tau}_w - g(1-\theta)H\nabla\eta^n \right) \right]
\end{equation}\]</div>
<p>and <span class="arithmatex">\(\pmb{F}\)</span> is the depth integrated term of <span class="arithmatex">\(\pmb{f}\)</span>, and <span class="arithmatex">\(\tilde{H}\)</span> is the depth enhanced by the bottom friction and form drag - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq07}
\tilde{H} = H + \left( \chi + \alpha \left| \pmb{u} \right| H\right)\Delta t
\end{equation}\]</div>
<p>The net effect of the vegetation is therefore equivalent to increase in the bottom drag, since the 3D structure of the flow/vegetation is not accounted for. Substituting Eq. <span class="arithmatex">\(\ref{eq05}\)</span> into Eq. <span class="arithmatex">\(\ref{eq04}\)</span> results in an integral equation for the unknown <span class="arithmatex">\(\eta^{n+1}\)</span> alone.</p>
<h2 id="locally-3d-case">Locally 3D case<a class="headerlink" href="#locally-3d-case" title="Permanent link">&para;</a></h2>
<p>We first integrate Eq. <span class="arithmatex">\(\ref{eq02}\)</span> from bottom to surface - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq08}
\frac{\pmb{U}^{n+1}-\pmb{U}^*}{\Delta t} = \pmb{F} - gH\theta\nabla\eta^{n+1} - gH(1-\theta)\nabla\eta^n + \pmb{\tau}_w - \chi\pmb{u}_b^{n+1} - \alpha\overline{\left| \pmb{u} \right|} \pmb{U}^{\alpha}
\end{equation}\]</div>
<p>where we have performed linearization of the vegetation term - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq09}
\int_{-h}^{z_v} \left|\pmb{u}\right|\pmb{u}dz \approx \overline{\left| \pmb{u} \right|} \equiv \overline{\left| \pmb{u} \right|} \pmb{U}^{\alpha} , (\text{where, }\pmb{U}^{\alpha} = \int_{-h}^{z_v}\pmb{u}dz)
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq10}
\overline{\left| \pmb{u} \right|} = \frac{1}{H^\alpha} \int_{-h}{z_v} \left| \pmb{u}^n \right| dz
\end{equation}\]</div>
<p>and <span class="arithmatex">\(H^\alpha = z_v +h\)</span> is the height of vegetation. Note that similar procedures have been used for other nonlinear terms (e.g. the quadratic bottom drag).</p>
<p>To eliminate <span class="arithmatex">\(\pmb{u}_b^{n+1}\)</span> in Eq <span class="arithmatex">\(\ref{eq08}\)</span>, we invoke the discretized momentum equation at the bottom cell and utilize the fact that the Reynolds stress is constant within the boundary layer, as shown in <a href="#zhang-baptista2008">Zhang and Baptista (2008)</a> - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq11}
\frac{\pmb{u}_b^{n+1} - \pmb{u}_b^*}{\Delta t} = \pmb{f}_b - g\theta\nabla\eta^{n+1} - g(1-\theta)\nabla\eta^n - \alpha\left|\pmb{u}_b\right|\pmb{u}_b^{n+1}
\end{equation}\]</div>
<p>from which <span class="arithmatex">\(\pmb{u}_b^{n+1}\)</span> can be formally solved as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq12}
\pmb{u}_b^{n+1} = \frac{1}{1+\alpha\left|\pmb{u}_b\right|\Delta t} \left[\pmb{u}_b^* +\pmb{f}_b\Delta t - g(1-\theta)\Delta t \nabla \eta^n \right] - \frac{g\theta\Delta t}{1+\alpha\left|\pmb{u}_b\right|\Delta t}\nabla\eta^{n+1}
\end{equation}\]</div>
<p>The subscript <span class="arithmatex">\(b\)</span> denotes the top of the bottom cell. Note that the main difference from the original formulation of <a href="#zhang-baptista2008">Zhang and Baptista (2008)</a> is the appearance of the vegetation term.</p>
<p>The remaining task is to find <span class="arithmatex">\(\pmb{U}^\alpha\)</span>. We’ll discuss two scenarios of submerged and emergent vegetation.</p>
<h3 id="emergent-vegetation">Emergent vegetation<a class="headerlink" href="#emergent-vegetation" title="Permanent link">&para;</a></h3>
<p>When the vegetation is locally emergent, i.e., <span class="arithmatex">\(H^\alpha \geq H\)</span>, we have <span class="arithmatex">\(\pmb{U}^\alpha = \pmb{U}^{n+1}\)</span>, and therefore <span class="arithmatex">\(\pmb{U}^{n+1}\)</span> can be found from Eq. <span class="arithmatex">\(\ref{eq08}\)</span> and <span class="arithmatex">\(\ref{eq12}\)</span> as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq13}
\pmb{U}^{n+1} = \pmb{G}_1 - \frac{g\theta\hat{H}\Delta t}{1+\alpha\overline{\left| \pmb{u} \right|} \Delta t} \nabla\eta^{n+1}
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\pmb{G}_1\)</span> contains explicit terms - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq14}
\pmb{G}_1 = \frac{\pmb{U}^* + (\pmb{F}+\pmb{\tau}_w)\Delta t - g(1-\theta)\hat{H}\Delta t \nabla\eta^n-\tilde{\chi}\Delta t (\pmb{u}_b^*+\pmb{f}_b\Delta t)}{1+\alpha\overline{\left| \pmb{u} \right|} \Delta t}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq15}
\tilde{\chi} = \frac{\chi}{1+\alpha \left| \pmb{u}_b \right| \Delta t}
\end{equation}\]</div>
<p>and <span class="arithmatex">\(\hat{H}\)</span> is a friction modified depth - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq16}
\hat{H} = H - \tilde{\chi}\Delta t
\end{equation}\]</div>
<p>Compared to the original formulation in <a href="#zhang-baptista2008">Zhang and Baptista (2008)</a>, the only change in this depth is the vegetation term in <span class="arithmatex">\(\tilde{\chi}\)</span>.</p>
<h3 id="submerged-vegetation">Submerged vegetation<a class="headerlink" href="#submerged-vegetation" title="Permanent link">&para;</a></h3>
<p>When the vegetation is submerged, i.e., <span class="arithmatex">\(H^\alpha &lt; H\)</span>, strong shear and turbulence develop between the vegetation and the overlying flow above it (<a href="#">ST94</a>). <a href="#">Nepf and Vivoni (2000)</a> demonstrated that there are two zones for submerged aquatic vegetation (SAV). In the upper canopy (called the ‘vertical exchange zone’), mean shear at the top of the canopy produces vertical turbulent exchange with the overlying water, which plays a significant role in the momentum balance. The lower canopy (‘longitudinal change zone’ as in <a href="#">Nepf and Vivoni, 2000</a>) communicates with surrounding water predominantly through longitudinal advection. The extent of the vertical exchange of momentum between the vegetation zone and overlying water is dependent on the submergence.</p>
<p>We first integrate the momentum equation (Eq. <span class="arithmatex">\(\ref{eq02}\)</span>) from the bottom to the top of canopy - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq17}
\pmb{U}^\alpha = \pmb{U}^{*\alpha} + \pmb{F}^\alpha\Delta t - g\theta H^\alpha \Delta t \nabla\eta^{n+1} - g(1-\theta)H^\alpha\Delta t \nabla \eta^n - \alpha \Delta t \overline{\left| \pmb{u} \right|} \pmb{U}^\alpha + \Delta t\nu \Bigr\rvert_{-h}^{z_v}
\end{equation}\]</div>
<p>where</p>
<div class="arithmatex">\[\begin{equation}
\label{eq18}
\begin{aligned}
\pmb{U}^{*\alpha} = \int_{-h}^{z_v}\pmb{u}^* dz\\
\pmb{F}^\alpha = \int_{-h}^{z_v}\pmb{f}dz
\end{aligned}
\end{equation}\]</div>
<p>The Reynolds stress at the top of canopy can be calculated from theory proposed by ST94. These authors found through lab experiments that the stress variation inside the vegetation layer approximately follows an exponential law</p>
<div class="arithmatex">\[\begin{equation}
\label{eq19}
\nu\frac{\partial\pmb{u}}{\partial z} \equiv \overline{u'w'} = \pmb{R}_0 e^{\beta_2 (z-z_v)} \text{ for } z \leq z_v
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\pmb{R}_0\)</span> is the stress at <span class="arithmatex">\(z=z_v\)</span>, and <span class="arithmatex">\(\beta_2\)</span> is determined by an empirical formula - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq20}
\beta_2 = \sqrt{\frac{\sqrt{N_v}}{H^\alpha}} \left[ -0.32 - 0.85 \log_{10} \left( \frac{H - H^\alpha}{H^\alpha} I\right) \right]
\end{equation}\]</div>
<p>where <span class="arithmatex">\(I\)</span> is an energy gradient - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq21}
I = \frac{\chi \left| \pmb{u}_b \right|}{gH}
\end{equation}\]</div>
<p>which is estimated from the previous time step in the model.</p>
<p>The stress term in Eq. <span class="arithmatex">\(\ref{eq19}\)</span> therefore becomes</p>
<div class="arithmatex">\[\begin{equation}
\label{eq22}
\nu\frac{\partial\pmb{u}}{\partial z}\Bigr\rvert_{-h}^{z_v} = \beta \chi \pmb{u}_b^{n+1}
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\beta = e^{\beta_2(z_v - z_b)}-1\)</span>, and <span class="arithmatex">\(z_b\)</span> is the location of the top of the bottom grid cell. Substituting Eq. <span class="arithmatex">\(\ref{eq22}\)</span> and Eq. <span class="arithmatex">\(\ref{eq12}\)</span> into Eq. <span class="arithmatex">\(\ref{eq17}\)</span> we can solve for <span class="arithmatex">\(\pmb{U}^\alpha\)</span> as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq23}
\pmb{U}^\alpha = \pmb{G}_3 - \frac{g\theta\hat{H}^\alpha\Delta t}{1+\alpha\overline{\left| \pmb{u}\right|}\Delta t}\nabla \eta^{n+1}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq24}
\pmb{G}_3 = \frac{\pmb{U}^{*\alpha}+\pmb{F}^\alpha\Delta t + \beta\tilde{\chi}\Delta t(\pmb{u}_b^* + \pmb{f}_b\Delta t) - g(1-\theta)\hat{H}^\alpha\Delta t \nabla \eta^n}{1+\alpha\overline{\left| \pmb{u} \right|}\Delta t}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq25}
\hat{H}^\alpha = H^\alpha + \beta\tilde{\chi}\Delta t
\end{equation}\]</div>
<p>Finally, substituting Eq. <span class="arithmatex">\(\ref{eq23}\)</span> and Eq. <span class="arithmatex">\(\ref{eq12}\)</span> into Eq. <span class="arithmatex">\(\ref{eq08}\)</span> results in a relationship between <span class="arithmatex">\(\pmb{U}^{n+1}\)</span> and <span class="arithmatex">\(\eta^{n+1}\)</span> - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq26}
\pmb{U}^{n+1} = \pmb{G}_2 - g\theta\overline{\overline{H}}\Delta t \nabla \eta^{n+1}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq27}
\overline{\overline{H}} = H - \tilde{\chi}\Delta t - c\hat{H}^\alpha
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq28}
c = \frac{\alpha\overline{\left| \pmb{u} \right|}\Delta t}{1 + \alpha\overline{\left| \pmb{u} \right|}\Delta t}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq29}
\pmb{G}_2 = \pmb{U}^* - c\pmb{U}^{*\alpha} + (\pmb{F} + \pmb{\tau_w})\Delta t - c\pmb{F}^\alpha\Delta t - \tilde{\chi}\Delta t(1+\beta c)(\pmb{u}_b^*+\pmb{f}_b\Delta t) - g(1-\theta)\overline{\overline{H}}\Delta t \nabla\eta^n
\end{equation}\]</div>
<h2 id="general-case">General case<a class="headerlink" href="#general-case" title="Permanent link">&para;</a></h2>
<p>In summary, the depth-integrated velocity can be expressed in compact form as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq30}
\pmb{U}^{n+1} = \pmb{E} - g\theta\breve{H}\Delta t\nabla\eta^{n+1}
\end{equation}\]</div>
<p>where, </p>
<div class="arithmatex">\[\begin{equation}
\label{eq31}
\begin{aligned}
\breve{H} = \begin{cases}
\frac{H^2}{\breve{H}}, \text{ 2D }\\
\frac{\hat{H}}{1+\alpha\overline{\left| \pmb{u} \right|}\Delta t}, \text{ 3D emergent }\\
\overline{\overline{H}}, \text{ 3D submerged }
\end{cases}
\end{aligned}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq32}
\begin{aligned}
\pmb{E} = \begin{cases}
\breve{\pmb{G}}, \text{ 2D }\\
\pmb{G}_1, \text{ 3D emergent }\\
\pmb{G}_2, \text{ 3D submerged }
\end{cases}
\end{aligned}
\end{equation}\]</div>
<p>Substituting Eq. <span class="arithmatex">\(\ref{eq30}\)</span> back into Eq. <span class="arithmatex">\(\ref{eq04}\)</span> gives an equation for the unknown elevations alone - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq33}
I_1 = I_4 - \theta\Delta t I_3 - (1-\theta)\Delta t I_5 - \theta\Delta t I_6 \text{, for } i=1, \cdots, N_p
\end{equation}\]</div>
<p>where,</p>
<div class="arithmatex">\[\begin{equation}
\label{eq34}
I_1 = \int_\Omega \left[ \phi_i \eta^{n+1} + g\theta^2\Delta t^2\ \check{H}\nabla\phi_i\cdot\nabla\eta^{n+1}\right]d\Omega
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq35}
I_4 = \int_\Omega \left[ \phi_i\eta^n + \theta\Delta t \nabla\phi_i\cdot\pmb{E} + (1-\theta)\Delta t \nabla\phi_i \cdot\pmb{U}^n \right]d\Omega
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq36}
I_3 = \int_{\Gamma_\nu} \phi_i\hat{U}_n^{n+1}d\Gamma_\nu
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq37}
I_5 = \int_\Gamma \phi_i U_n^n d\Gamma
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq38}
I_6 = \int_{\overline{\Gamma}_\nu} \phi_i U_n^{n+1} d\overline{\Gamma}_\nu
\end{equation}\]</div>
<p>Following standard finite-element procedures, and using appropriate essential and natural boundary conditions, SCHISM solves Eq. <span class="arithmatex">\(\ref{eq33}\)</span> to determine the elevations at all nodes. Note that the RHS terms <span class="arithmatex">\(I_{3-6}\)</span> are known; in the case of <span class="arithmatex">\(I_6\)</span>, the integrals on <span class="arithmatex">\(\overline{\Gamma}_\nu\)</span> need not be evaluated since the essential boundary conditions are imposed by eliminating corresponding rows and columns of the matrix.</p>
<p>The matrix resulting from Eq. <span class="arithmatex">\(\ref{eq33}\)</span> is sparse and symmetric. It is also positive-definite as long as the depth <span class="arithmatex">\(\breve{H}\)</span> is non-negative (<code>ihhat=1</code>); numerical experiments indicated that even this restriction can be relaxed for many practical applications that include shallow areas. We show that the addition of vegetation does not introduce additional stability constraint. The effects of the vegetation on <span class="arithmatex">\(\breve{H}\)</span> are generally similar to the bottom friction. For the 2D case, <span class="arithmatex">\(\breve{H}\)</span> is always positive. For the 3D emergent case, the vegetation term in the denominator is positive and so does not change the sign. For the 3D submerged case, as <span class="arithmatex">\(\alpha \rightarrow 0\)</span>, previous results of <a href="#zhang-baptista2008">Zhang and Baptista (2008)</a> are recovered. As <span class="arithmatex">\(\alpha \rightarrow \infty\)</span> (i.e., very dense vegetation), the friction term (the second term in Eq. <span class="arithmatex">\(\ref{eq27}\)</span>) dwarfs in comparison with the vegetation term (the third term in Eq. <span class="arithmatex">\(\ref{eq27}\)</span>), and therefore the friction is negligible under dense vegetation. Since <span class="arithmatex">\(c \rightarrow 1\)</span> as <span class="arithmatex">\(\alpha \rightarrow \infty\)</span>, <span class="arithmatex">\(\breve{H}\)</span> approaches the submergence <span class="arithmatex">\(H-H^\alpha\)</span>, which is positive. When the submergence is very small (i.e. almost emergent vegetation), <span class="arithmatex">\(\breve{H} \rightarrow 0\)</span> and the conditioning of the matrix would somewhat deteriorate but the model remains stable. Physically, this means that very strong shear will develop near the canopy.</p>
<p>It’s important to notice that the friction-modified depth is different between 2D and 3D cases, which has implications in shallow depths. We show more details of the evaluation of the integrals <span class="arithmatex">\(I_i\)</span> below. The corresponding constant for 2D prisms is always positive (see below) and therefore the 2D mode is inherently more stable than 3D mode; consequently, judiciously leveraging SCHISM’s polyphorphism enhances stability near the wetting and drying interface. The matrix can be efficiently solved using a pre-conditioned Conjugate Gradient method (<a href="#casulli1994">Casulli and Cattani 1994</a>). This simple matrix solver is implemented in SCHISM; alternatively, the efficient parallel matrix solver PETSc can be used for large matrices.</p>
<p>In the model, the decision on 2D/3D emergent/3D submerged scenarios is made at each side (where the velocity is defined) based on the total depths from the previous time step and the transition of regimes is handled in the model.</p>
<h3 id="integral-i_3">Integral <span class="arithmatex">\(I_3\)</span><a class="headerlink" href="#integral-i_3" title="Permanent link">&para;</a></h3>
<p>This is a boundary integral that only need to be evaluated when the node <span class="arithmatex">\(i\)</span> is located on an open boundary segment where Neuman-type B.C. is prescribed. Since the unknowns vary linearly along any side, we have (cf. Figure <a href="#figure01">1</a>) -</p>
<div class="arithmatex">\[\begin{equation}
\label{eq39}
I_3 = \sum_j \frac{L_{ij}}{2} \sum_{k=kbs}^{N_z-1} \Delta z_{j,k+1} \frac{\hat{u}_{j,k+1}^{n+1} + \hat{u}_{j,k}^{n+1}}{2}
\end{equation}\]</div>
<p>where the outer sum is carried out along the 2 adjacent open side <span class="arithmatex">\(j\)</span>, <span class="arithmatex">\(L_{ij}\)</span> is the side length, <span class="arithmatex">\(\Delta z_{j,k+1}\)</span> is the layer thickness along side <span class="arithmatex">\(j\)</span>, and <span class="arithmatex">\(kbs\)</span> is the local bottom index.</p>
<figure id="figure01">
<p><img alt="Boundary node" src="../assets/bnd-elem.png" /></p>
<figcaption>Boundary node i with adjacent sides.</figcaption>
</figure>
<p>If a Flather-type radiation condition (<a href="#flather1987">Flather 1987</a>) needs to be applied, it can be done in the following fashion - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq40}
\hat{U}_n^{n+1} - \overline{U}_n = \sqrt{\frac{g}{H}} (\eta^{n+1} - \overline{\eta})
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\overline{U}_n\)</span> and <span class="arithmatex">\(\overline{\eta}\)</span> are specified mean incoming current and mean elevation. Then - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq41}
I_3 = \sum_j \frac{L_{ij}(\overline{U}_n)_{ij}}{2} + \frac{L_{ij}\sqrt{gH_{ij}}}{6} \left[ 2(\eta_i^{n+1} - \overline{\eta}_i) + (\eta_j^{n+1} - \overline{\eta}_j) \right]
\end{equation}\]</div>
<p>In this case, the unknown <span class="arithmatex">\(\eta^{n+1}\)</span> need to be moved to the LHS, and the diagonal (associated with <span class="arithmatex">\(\eta_i^{n+1}\)</span>) is enhanced as a result and matrix symmetry is preserved.</p>
<h3 id="integral-i_5">Integral <span class="arithmatex">\(I_5\)</span><a class="headerlink" href="#integral-i_5" title="Permanent link">&para;</a></h3>
<p>Similar to <span class="arithmatex">\(I_3\)</span>, we have - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq42}
I_5 = \sum_j \frac{L_{ij}}{2} \sum_{k=kbs}^{N_z-1} \Delta z_{j, k+1} \frac{u_{j, k+1}^{n} + u_{j,k}^{n}}{2}
\end{equation}\]</div>
<h3 id="integral-i_1">Integral <span class="arithmatex">\(I_1\)</span><a class="headerlink" href="#integral-i_1" title="Permanent link">&para;</a></h3>
<p>This is the only implicit term. Referring to Figure <a href="#figure02">2</a>, we have - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq43}
I_1 = \sum_{j=1}^{Nb(i)} \sum_{l=1}^{i34(j)} \eta_{j,l}^{n+1} \int_{A_j} \hat{\phi_{i'}} \hat{\phi_l} dA_j + g\theta^2 \Delta t^2 \sum_{j=1}^{Nb(i)} \overline{\check{H}_j} \sum_{l=1}^{i34(j)} \eta_{j,l}^{n+1} \int_{A_j} \nabla\hat{\phi_{i'}}\cdot\nabla\hat{\phi_l} dA_j
\end{equation}\]</div>
<p>Where <span class="arithmatex">\(j\)</span> is a neighbouring element of <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(i'\)</span> is the local index of node <span class="arithmatex">\(i\)</span> inside element <span class="arithmatex">\(j\)</span>, overbar in <span class="arithmatex">\(\overline{\check{H}}\)</span> denotes element averating, and <span class="arithmatex">\(\hat{\phi}\)</span> is the local linear shape function. We discuss the case of a triangle and quad element.</p>
<figure id="figure02">
<p><img alt="Node ball I1" src="../assets/i1-node-ball.png" width="500px" /></p>
<figcaption>Node ball used in calculating integral I 1.</figcaption>
</figure>
<h4 id="case-i-triangle">Case I: triangle<a class="headerlink" href="#case-i-triangle" title="Permanent link">&para;</a></h4>
<p>The 2 integrals can be evaluated analytically as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq44}
\int_{A_j} \hat{\phi_{i'}} \hat{\phi_l} dA_j = \frac{1+\delta_{i',l}}{12}A_j
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq45}
\int_{A_j} \nabla\hat{\phi_{i'}} \cdot \nabla\hat{\phi_l} dA_j = \frac{\vec{i'}\cdot\vec{l}}{4A_j}
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\vec{i'}\)</span> and <span class="arithmatex">\(\vec{l}\)</span> are two vectors along side <span class="arithmatex">\(i'\)</span> and <span class="arithmatex">\(l\)</span> respectively, and <span class="arithmatex">\(\delta_{i',l}\)</span> is the Kronecker delta - </p>
<div class="arithmatex">\[\begin{equation*}
\delta_{i',l} = \begin{cases}
1, i' = l \\
0, i' \neq l
\end{cases}
\end{equation*}\]</div>
<h4 id="case-ii-quad">Case II: Quad<a class="headerlink" href="#case-ii-quad" title="Permanent link">&para;</a></h4>
<p>We can analytically evaluate integral Eq. <span class="arithmatex">\(\ref{eq44}\)</span> as - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq46}
\int_{A_j} \hat{\phi_{i'}}\hat{\phi_l}dA_j = \frac{A_j}{16}\left(1+\frac{1}{3}\xi_{i'}\xi_l\right)\left(1+\frac{1}{3}\varsigma_{i'}\varsigma_l\right) + \frac{B_1}{96}\left(1+\frac{1}{3}\varsigma_{i'}\varsigma_l\right)\left(\xi_{i'}+\xi_l\right) + \frac{B_2}{96}\left(1+\frac{1}{3}\xi_{i'}\xi_l\right)\left(\varsigma_{i'}+\varsigma_l\right)
\end{equation}\]</div>
<p>Where <span class="arithmatex">\((\xi, \varsigma)\)</span> are local coordinates, and <span class="arithmatex">\(B_1\)</span> and <span class="arithmatex">\(B_2\)</span> are 2 geometric constants (Figure <a href="#figure03">3</a>) - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq47}
\begin{aligned}
B_1 = \left(\vec{12}\times\vec{43}\right)_k = \left(x_2-x_1\right)\left(y_3-y_4\right) - \left(x_3-x_4\right)\left(y_2-y_1\right)\\
B_2 = \left(\vec{23}\times\vec{14}\right)_k
\end{aligned}
\end{equation}\]</div>
<figure id="figure03">
<p><img alt="Quad element" src="../assets/quad-element.png" /></p>
<figcaption>Quad element and local transformation.</figcaption>
</figure>
<p>The other integral Eq. <span class="arithmatex">\(\ref{eq45}\)</span> cannot be evaluated analytically and so we use the 4-point Gauss quadrature.</p>
<h3 id="integral-i_4">Integral <span class="arithmatex">\(I_4\)</span><a class="headerlink" href="#integral-i_4" title="Permanent link">&para;</a></h3>
<p>This integral contains most of the explicit terms. Most terms are straightforward to evaluate, e.g., using element averaging or analytical integration (in the case of volume sources/sinks); the integrals involving the shape function or its derivative can be calculated using the similar method as in <span class="arithmatex">\(I_1\)</span>. Therefore we will only discuss the a few terms below given their importance in SCHISM.</p>
<h4 id="baroclinicity">Baroclinicity<a class="headerlink" href="#baroclinicity" title="Permanent link">&para;</a></h4>
<p>Since a FVM is used to solve the tracers (including T,S) at the prism center, we evaluate the density gradient at prism center via a reconstruction method. Referring to Figure <a href="#figure04">4</a>, given a prism center '0', we first project the gradient onto vectors connecting adjacent prism centers - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq48}
\frac{\partial\rho}{\partial x}\left(x_1-x_0\right) + \frac{\partial\rho}{\partial y}\left(y_1-y_0\right) = \rho_1-\rho_0
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq49}
\frac{\partial\rho}{\partial x}\left(x_2-x_0\right) + \frac{\partial\rho}{\partial y}\left(y_2-y_0\right) = \rho_2-\rho_0
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq50}
\frac{\partial\rho}{\partial x}\left(x_3-x_0\right) + \frac{\partial\rho}{\partial y}\left(y_3-y_0\right) = \rho_3-\rho_0
\end{equation}\]</div>
<p>after a cubic spline interpolation has been performed to calculate the density at prism '1' at the same vertical location as ‘0’ (i.e. (<span class="arithmatex">\(i\)</span>,<span class="arithmatex">\(k\)</span>)). Note that if the element <span class="arithmatex">\(i\)</span> is a quad, we will have 4 equations. We then solve pairs of equations to find for <span class="arithmatex">\(\nabla\rho\)</span>, i.e., Eq. <span class="arithmatex">\(\ref{eq48}\)</span> with Eq. <span class="arithmatex">\(\ref{eq49}\)</span>, Eq. <span class="arithmatex">\(\ref{eq49}\)</span> with Eq. <span class="arithmatex">\(\ref{eq50}\)</span>, and Eq. <span class="arithmatex">\(\ref{eq50}\)</span> with Eq. <span class="arithmatex">\(\ref{eq48}\)</span>. If the 3 centers happen to be co-linear, the equations have no solution and are discarded; however, at least 1 pair has a valid solution. </p>
<figure id="figure04">
<p><img alt="Reconstruction method" src="../assets/reconstruction-method.png" /></p>
<figcaption>Reconstruction method. i is the element index and k is the vertical index.</figcaption>
</figure>
<p>If a neighbor does not exist (boundary) or is dry, we replace the corresponding equation with the no-flux B.C.; e.g., if AB is such a side, then -</p>
<div class="arithmatex">\[\begin{equation}
\label{eq51}
\frac{\partial\rho}{\partial y}\left(x_A-x_B\right) + \frac{\partial\rho}{\partial x}\left(y_B-y_A\right) = 0
\end{equation}\]</div>
<p>After the density gradients are found at prism centers, a simple linear interpolation in the vertical is used to calculate the gradients at side centers (and half levels). Then the trapezoidal rule is used to compute the baroclinic term: <span class="arithmatex">\(-\frac{g}{\rho_0}\int_z^\eta\nabla\rho dz\)</span>. This will also be utilized in the solution of the momentum equation.</p>
<h4 id="horizontal-viscosity">Horizontal viscosity<a class="headerlink" href="#horizontal-viscosity" title="Permanent link">&para;</a></h4>
<p>Momentum stabilization is an important consideration in designing advection and viscosity schemes. <a href="#zhang2016">Zhang et al. (2016)</a> demonstrated that the standard Laplacian viscosity is equivalent to the 5-point Shapiro filter (see below) on uniform grids; however, on non-uniform grids, it may behave like an ‘amplifier’ and therefore the filter form should be used instead (Figure <a href="#figure05">5a,b</a>) - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq52}
\nabla\cdot\left(\mu\nabla u\right)\Biggr|_0 = \frac{\mu_0}{\sqrt{3}A_I}\left(u_1+u_2+u_3+u_4-4u_0\right)
\end{equation}\]</div>
<p>where all velocities have been interpolated onto a horizontal plane using linear interpolation in the vertical. </p>
<figure id="figure05">
<p><img alt="Viscosity stencil" src="../assets/viscosity-stencil.png" /></p>
<figcaption>Shapiro filters and viscosity stencil for (a) triangular and (b) quadrangular elements. 'I' and 'II' are 2 adjacent elements of side of interest ('0'). The extended stencil used in constructing bi-harmonic viscosity is shown in (c). The special case of a boundary side is shown in (d).</figcaption>
</figure>
<p>The bi-harmonic viscosity is often superior to the Laplacian viscosity as it is more discriminating in removing sub-grid instabilities without adversely affecting the resolved scales of flow (Griffies and Hallberg 2000). The bi-harmonic viscosity can be implemented by applying the Laplacian operator twice. Referring to Figure <a href="#figure05">5c</a>, we have - </p>
<div class="arithmatex">\[\begin{equation}
\label{eq53}
\begin{aligned}
-\lambda\nabla^4u\Biggr|_0 
&amp;= -\lambda\gamma_3\left( \nabla^2 u_1 + \nabla^2 u_2 + \nabla^2 u_3 + \nabla^2 u_4 - 4\nabla^2 u_0 \right)\\
&amp;= \frac{\gamma_2}{\Delta t}\left[ 7\left( u_1 + u_2 + u_3 + u_4\right) - u_{1a} - u_{1b} - u_{2a} - u_{2b} - u_{3a} - u_{3b} - u_{4a} - u_{4b} - 20u_0 \right]
\end{aligned}
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\lambda\)</span>  is a hyper viscosity in <span class="arithmatex">\(m^4/s\)</span>, <span class="arithmatex">\(\gamma_3 = \frac{1}{\sqrt{3}A_I}\)</span> and <span class="arithmatex">\(\gamma_2 = \lambda\gamma_3^2\Delta t\)</span> is a diffusion-number-like dimensionless constant. We found that in practice <span class="arithmatex">\(\gamma_2 \leq 0.025\)</span>  is sufficient to suppress inertial spurious modes.</p>
<p><strong>References</strong></p>
<p><span id="casulli1994">Casulli, V. and E. Cattani (1994) Stability, accuracy and efficiency of a semi-implicit method for 3D shallow water flow. Computers &amp; Mathematics with Applications, 27, pp. 99-112.</span></p>
<p><span id="flather1987">Flather, R.A. (1987) A tidal model of Northeast Pacific. Atmosphere-Ocean, 25, pp. 22-45.</span></p>
<p><span id="zhang-baptista2008">Zhang, Y. and Baptista, A.M. (2008) "SELFE: A semi-implicit Eulerian-Lagrangian finite-element model for cross-scale ocean circulation", Ocean Modelling, 21(3-4), 71-96</span></p>
<p><span id="zhang2016">Zhang, Y., Ye, F., Stanev, E.V., Grashorn, S. (2016). Seamless cross-scale modeling with SCHISM, Ocean Modelling, 102, 64-81. doi:10.1016/j.ocemod.2016.05.002</span></p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="geometry-discretization.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Geometry and discretization" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Geometry and discretization
            </div>
          </div>
        </a>
      
      
        
        <a href="eulerian-lagrangian-method.html" class="md-footer__link md-footer__link--next" aria-label="Next: Eulerian-Lagrangian Method" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Eulerian-Lagrangian Method
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "toc.follow", "content.code.annotate"], "search": "../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f758a944.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>