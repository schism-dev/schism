
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-8.3.4">
    
    
      
        <title>Physical formulation - SCHISM</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#governing-equations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="SCHISM" class="md-header__button md-logo" aria-label="SCHISM" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SCHISM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Physical formulation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/schism-dev/schism" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="SCHISM" class="md-nav__button md-logo" aria-label="SCHISM" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    SCHISM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/schism-dev/schism" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog.html" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/getting-sourcecode.html" class="md-nav__link">
        Getting the source code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/compilation.html" class="md-nav__link">
        Compilation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/test_suite.html" class="md-nav__link">
        Test suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/typical-workflow.html" class="md-nav__link">
        Typical workflow (a cheat sheet)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/grid-generation.html" class="md-nav__link">
        Mesh generation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing.html" class="md-nav__link">
        Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_8" type="checkbox" id="__nav_3_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_8">
          Preprocessing with pylib
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Preprocessing with pylib" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Preprocessing with pylib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pylib/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pylib/installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pylib/schismcheck.html" class="md-nav__link">
        schismCheck (input visualization)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_9" type="checkbox" id="__nav_3_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_9">
          Preprocessing with PySCHISM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Preprocessing with PySCHISM" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          Preprocessing with PySCHISM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/bctides.html" class="md-nav__link">
        Tides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/boundary.html" class="md-nav__link">
        B.C. from HYCOM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/atmos.html" class="md-nav__link">
        Atmospheric forcing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/pre-processing-with-pyschism/nwm.html" class="md-nav__link">
        Souce and Sink
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/running-model.html" class="md-nav__link">
        Running the model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/visualization.html" class="md-nav__link">
        Visualization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/post-processing.html" class="md-nav__link">
        Postprocessing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Model formulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model formulation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Model formulation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Physical formulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="physical-formulation.html" class="md-nav__link md-nav__link--active">
        Physical formulation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#governing-equations" class="md-nav__link">
    Governing equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions-bc" class="md-nav__link">
    Boundary conditions (B.C.)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#turbulence-closure" class="md-nav__link">
    Turbulence closure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#air-sea-exchange" class="md-nav__link">
    Air-sea exchange
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Numerical formulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Numerical formulation" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Numerical formulation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="geometry-discretization.html" class="md-nav__link">
        Geometry and discretization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="barotropic-solver.html" class="md-nav__link">
        Barotropic solver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="eulerian-lagrangian-method.html" class="md-nav__link">
        Eulerian-Lagrangian Method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="momentum-equation.html" class="md-nav__link">
        Momentum equation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="vertical-velocity.html" class="md-nav__link">
        Vertical velocity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="turbulence-closure.html" class="md-nav__link">
        Turbulence closure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="transport-equation.html" class="md-nav__link">
        Transport equation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="updating-levels.html" class="md-nav__link">
        Updating the levels/Inundation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="spherical-coordinates.html" class="md-nav__link">
        Spherical coordinates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Input/Output
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Input/Output" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Input/Output
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/hgrid.html" class="md-nav__link">
        Horizontal grid (hgrid.gr3)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/vgrid.html" class="md-nav__link">
        Vertical grid (vgrid.in)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/param.html" class="md-nav__link">
        Model parameters (param.nml)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/bctides.html" class="md-nav__link">
        Boundary conditions (bctides.in)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/friction.html" class="md-nav__link">
        Bottom friction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/sflux.html" class="md-nav__link">
        Atmospheric flux (/sflux)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/optional-inputs.html" class="md-nav__link">
        Optional inputs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input-output/outputs.html" class="md-nav__link">
        Outputs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Mesh generation - advanced topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mesh generation - advanced topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Mesh generation - advanced topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/cross_regime.html" class="md-nav__link">
        Meshing for cross-scale regimes
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Meshing for compound floods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Meshing for compound floods" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Meshing for compound floods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/extract-thalweg.html" class="md-nav__link">
        Extract thalwegs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/generate-river-map.html" class="md-nav__link">
        Generate river map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mesh-generation/meshing-for-compound-floods/meshing-in-SMS.html" class="md-nav__link">
        Meshing in SMS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/generic-tracer.html" class="md-nav__link">
        Generic tracer module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/age.html" class="md-nav__link">
        AGE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/sed2d.html" class="md-nav__link">
        2D Sediment model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/sed3d.html" class="md-nav__link">
        3D Sediment model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/icm.html" class="md-nav__link">
        ICM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/cosine.html" class="md-nav__link">
        CoSiNe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/dvd.html" class="md-nav__link">
        DVD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/marsh-migration.html" class="md-nav__link">
        Marsh migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/analysis-mode.html" class="md-nav__link">
        Analysis mode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/hydraulics.html" class="md-nav__link">
        Hydraulics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/particle-tracking.html" class="md-nav__link">
        Particle tracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/wwm.html" class="md-nav__link">
        WWM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/fabm.html" class="md-nav__link">
        FABM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/pahm.html" class="md-nav__link">
        PaHM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/single-class-ice.html" class="md-nav__link">
        Single-class ice module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../code-contribution.html" class="md-nav__link">
        Code structure
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../case-study.html" class="md-nav__link">
        Case studies
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          SCHISM external coupling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SCHISM external coupling" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          SCHISM external coupling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/esmf.html" class="md-nav__link">
        Earth System Modeling Framework
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/nuopc.html" class="md-nav__link">
        National Unified Operational Prediction Capability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/coastalapp.html" class="md-nav__link">
        NOAA's CoastalApp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/mossco.html" class="md-nav__link">
        Modular System for Shelves and Coasts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coupling/cesm.html" class="md-nav__link">
        NCAR's Community Earth System Model
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq.html" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../known_issues.html" class="md-nav__link">
        Known issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute-to-this-online-manual.html" class="md-nav__link">
        Contribute to this online manual
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/schism-dev/schism/edit/master/docs/schism/physical-formulation.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>Physical formulation</h1>

<h2 id="governing-equations">Governing equations<a class="headerlink" href="#governing-equations" title="Permanent link">&para;</a></h2>
<p>We will focus only on the hydrostatic solver in side SCHISM. Under this mode, we solve the standard Navier-Stokes equations with hydrostatic and Boussinesq approximations, including the effects of vegetation.</p>
<p>Momentum equation: </p>
<div class="arithmatex">\[\begin{equation}
\begin{aligned}
\frac{Du}{dt} = \pmb{f} - g \nabla \eta + \pmb{m}_z - \alpha \left| \pmb{u} \right| \pmb{u} L(x, y, z)\\
\pmb{f} = f(v, -u) - \frac{g}{\rho_0} \int_z^{\eta} \nabla \rho d\zeta - \frac{\nabla p_A}{\rho_0} + a g \nabla \Psi + \pmb{F}_m + other
\end{aligned}
\label{eq:momentum}
\end{equation}\]</div>
<p>Continuity equation in 3D and 2D depth-integrated forms:</p>
<div class="arithmatex">\[\begin{align}
\nabla \cdot \pmb{u} + \frac{\partial w}{\partial z} = 0\\
\frac{\partial \eta}{\partial t} + \nabla \cdot \int_{-h}^{\eta} \pmb{u} dz = 0
\end{align}\]</div>
<p>Transport equations:</p>
<div class="arithmatex">\[\begin{equation}
\frac{\partial C}{\partial t} + \nabla \cdot (\pmb{u}C) = \frac{\partial}{\partial z} \left( \kappa \frac{\partial C}{\partial z} \right) + F_h 
\end{equation}\]</div>
<p>Equation of state:</p>
<div class="arithmatex">\[\begin{equation*}
\rho = \rho(S, T, p)
\end{equation*}\]</div>
<p>Where, </p>
<ul>
<li><span class="arithmatex">\(\nabla\)</span> : <span class="arithmatex">\(\left( \frac{\partial}{\partial x}, \frac{\partial}{\partial y} \right)\)</span></li>
<li><span class="arithmatex">\(\frac{D}{Dt}\)</span> : material derivative</li>
<li><span class="arithmatex">\((x, y)\)</span>: horizontal Cartesian coordinates</li>
<li><span class="arithmatex">\(z\)</span>: vertical coordinate, positive upward</li>
<li><span class="arithmatex">\(t\)</span>: time</li>
<li><span class="arithmatex">\(\eta(x, y, t)\)</span>: free-surface elevation in meters [<span class="arithmatex">\(m\)</span>]</li>
<li><span class="arithmatex">\(h(x, y)\)</span>: bathymetric depth (measured from a fixed datum) [<span class="arithmatex">\(m\)</span>]</li>
<li><span class="arithmatex">\(\pmb{u}(x, y, z, t)\)</span>: horizontal velocity, with Cartesian components <span class="arithmatex">\((u, v)\)</span> [<span class="arithmatex">\(m/s\)</span>]</li>
<li><span class="arithmatex">\(w(x, y, z, t)\)</span>: vertical velocity [<span class="arithmatex">\(m/s\)</span>]</li>
<li><span class="arithmatex">\(p\)</span>: hydrostatic pressure [<span class="arithmatex">\(Pa\)</span>]</li>
<li><span class="arithmatex">\(p_A\)</span>: atmospheric pressure reduced to mean sea level (MSL) [<span class="arithmatex">\(Pa\)</span>]</li>
<li><span class="arithmatex">\(\rho, \rho_0\)</span>: water density and reference water density [<span class="arithmatex">\(kg/m^3\)</span>]</li>
<li><span class="arithmatex">\(\pmb{f}\)</span>: other forcing terms in momentum (baroclinic gradient, horizontal viscosity, Coriolis, earth tidal potential, atmospheric pressure, radiation stress). These are usually treated explicitly in the numerical formulation</li>
<li><span class="arithmatex">\(g\)</span>: acceleration of gravity, in [<span class="arithmatex">\(m/s^2\)</span>]</li>
<li><span class="arithmatex">\(C\)</span>: tracer concentration (e.g., salinity, temperature, sediment etc)</li>
<li><span class="arithmatex">\(\nu\)</span>: vertical eddy viscosity, in [<span class="arithmatex">\(m^2/s\)</span>]</li>
<li><span class="arithmatex">\(\kappa\)</span>: vertical eddy diffusivity, for tracers, in [<span class="arithmatex">\(m^2/s\)</span>]</li>
<li><span class="arithmatex">\(\pmb{F}_m\)</span>: horizontal viscosity [<span class="arithmatex">\(m^2/s\)</span>]</li>
<li><span class="arithmatex">\(F_h\)</span>: horizontal diffusion and mass sources/sinks [<span class="arithmatex">\(m^2/s\)</span>]</li>
</ul>
<p>Vegetation effects have been accounted for in Eq. 1. The main vegetation parameter is <span class="arithmatex">\(\alpha(x, y) = D_v N_v C_{Dv}/2\)</span> is a vegetation related density variable in [<span class="arithmatex">\(m^{-1}]\)</span>, where <span class="arithmatex">\(D_v\)</span> is the stem diameter, <span class="arithmatex">\(N_v\)</span> is the vegetation density (number of stems per <span class="arithmatex">\(m^2\)</span>), and <span class="arithmatex">\(C_{Dv}\)</span> is the bulk form drag coefficient. Selection of <span class="arithmatex">\(C_{Dv}\)</span> is the topic of other studies with values between 0 and 3 (<a href="#">Nepf and Vivoni 2000</a>; <a href="#">Tanino and Nepf 2008</a>), and is validated against reported lab study values. The underlying assumption used here is to treat the vegetation as arrays of solid cylinders, which is only a first-order approximation of the problem. Flexibility of the vegetation, sheltering effects within a cluster of vegetation can lead to one to two orders of reduction in the drag forces, and <a href="#">Gaylord et al. (2008)</a> showed that the drag formulation is also species dependent. These additional complexities are outside the scope of the current study. In this paper, we assume <span class="arithmatex">\(C_{Dv}\)</span> is a constant, but a vertically varying <span class="arithmatex">\(C_{Dv}\)</span> (as suggested by <a href="#">Nepf and Vivoni 2000</a> and others) can be easily added as well; the latter can be used to approximate flexible stems (<a href="#">Nepf and Vivoni 2000</a>; Luhar and Nepf 2011).</p>
<p>Since SCHISM allows ‘polymorphism’ with mixed 2D and 3D cells in a single grid (<a href="#zhang2016">Zhang et al. 2016</a>), we have different forms for the vertical eddy viscosity term <span class="arithmatex">\(\pmb{m}_z\)</span> and vegetation term <span class="arithmatex">\(L(x, y, z)\)</span>. </p>
<div class="arithmatex">\[\begin{equation}
\begin{aligned}
    \pmb{m}_z= 
\begin{cases}
    \frac{\partial}{\partial z}\left( \nu \frac{\partial \pmb{u}}{\partial z} \right),&amp; \text{3D cells}\\
    \frac{\pmb{\tau}_w - \chi \pmb{u}}{H}, &amp; \text{2D cells}
\end{cases}\\
    L(x, y, z)= 
\begin{cases}
    \mathcal{H}(z_v - z),&amp; \text{3D}\\
    1,              &amp; \text{2D}
\end{cases}
\end{aligned}
\end{equation}\]</div>
<p>where, <span class="arithmatex">\(\nu\)</span> is the eddy viscosity, <span class="arithmatex">\(\pmb{\tau}_w\)</span> is the surface wind stress, <span class="arithmatex">\(H=h+\eta\)</span> is the total water depth (with <span class="arithmatex">\(h\)</span> being the depth measured from a fixed datum), <span class="arithmatex">\(\chi = C_d \left| \pmb{u} \right|\)</span>, <span class="arithmatex">\(C_D\)</span> is the bottom drag coefficient, <span class="arithmatex">\(z_v\)</span>  is the z-coordinate of the canopy, and <span class="arithmatex">\(\mathcal{H}()\)</span> is the Heaviside step function - </p>
<div class="arithmatex">\[\begin{equation*}
\mathcal{H} = 
\begin{cases}
    1, &amp; x \geq 0\\
    0, &amp; x \lt 0
\end{cases}
\end{equation*}\]</div>
<p>Note that <span class="arithmatex">\(\pmb{u}\)</span> denotes the depth-averaged velocity in a 2D region.</p>
<h2 id="boundary-conditions-bc">Boundary conditions (B.C.)<a class="headerlink" href="#boundary-conditions-bc" title="Permanent link">&para;</a></h2>
<p>The differential equations above need initial condition (I.C.) and B.C. In general, all state variables (<span class="arithmatex">\(\eta\)</span>, <span class="arithmatex">\(\pmb{u}\)</span>, <span class="arithmatex">\(C\)</span>) are specified at <span class="arithmatex">\(t=0\)</span> as I.C. and these are also specified at all open <em>lateral</em> boundary segments (open ocean, rivers etc). However, not all variables need to be specified at all boundary segments and we’ll revisit this in the input-output section, i.e., <a href="../input-output/bctides.html">bctides</a>.</p>
<p>The vertical B.C. for (Eq 1-4) are described in detail below as these impact the numerical scheme. Note that these only apply to 3D cells; for 2D cells, Eq. 1a has taken into account the B.C.</p>
<p>At the sea surface, SCHISM enforces the balance between the internal Reynolds stress and the applied shear stress.</p>
<div class="arithmatex">\[\begin{equation}
\nu \frac{\partial \pmb{u}}{\partial z} = \pmb{\tau}_w, \text{ at } z = \eta
\end{equation}\]</div>
<p>where the stress <span class="arithmatex">\(\pmb{\tau}_z\)</span> can be parameterized using the approach of <a href="#zeng1998">Zeng et al. (1998)</a> or the simpler approach of <a href="#pond1998">Pond and Pickard (1998)</a>. If the Wind Wave Model is invoked, it can also be calculated from the wave model.</p>
<p>Because the bottom boundary layer is usually not well resolved in ocean models, the no-slip condition at the sea or river bottom (<span class="arithmatex">\(\pmb{u} = w = 0\)</span>) is replaced by a balance between the internal Reynolds stress and the bottom frictional stress. </p>
<div class="arithmatex">\[\begin{equation}
\nu \frac{\partial \pmb{u}}{\partial z} = \pmb{\tau}_b, \text{ at } z=-h
\end{equation}\]</div>
<p>The specific form of the bottom stress <span class="arithmatex">\(\pmb{\tau}_b\)</span> depends on the type of boundary layer used and here we will only discuss the turbulent boundary layer below (Blumberg and Mellor 1987), given its prevalent usage in ocean modeling. The bottom stress is then - </p>
<div class="arithmatex">\[\begin{equation}
\pmb{\tau}_b = C_D \left| \pmb{u}_b \right| \pmb{u}_b \equiv \chi \pmb{u}_b
\end{equation}\]</div>
<p>The velocity profile in the interior of the bottom boundary layer obeys the logarithmic law, which is smoothly matched to the exterior flow at the top of the boundary layer.</p>
<div class="arithmatex">\[\begin{equation}
\pmb{u} = \frac{ln[(z+h)/z_0]}{ln(\delta_b/z_0)}\pmb{u}_b, z_0-h \leq z \leq \delta_b -h
\end{equation}\]</div>
<p>Here, <span class="arithmatex">\(\delta_b\)</span> is the thickness of the bottom computational cell (assuming that the bottom is sufficiently resolved in SCHISM that the bottom cell is inside the boundary layer), <span class="arithmatex">\(z_0\)</span> is the bottom roughness, and <span class="arithmatex">\(\pmb{u}_b\)</span> is the velocity measured at the top of the bottom computational cell. Therefore the Reynolds stress inside the boundary layer is derived as - </p>
<div class="arithmatex">\[\begin{equation}
\nu \frac{\partial \pmb{u}}{\partial z} = \frac{\nu}{(z+h)ln(\delta_b/z_0)}  \pmb{u}_b
\end{equation}\]</div>
<p>Utilizing the turbulence closure theory discussed below, we can show that the Reynolds stress is constant inside the boundary layer - </p>
<div class="arithmatex">\[\begin{equation}
\nu \frac{\partial \pmb{u}}{\partial z} = \frac{\kappa_0}{ln(\delta_b/z_0)} C_D^{1/2} \left| \pmb{u}_b \right| \pmb{u}_b, z_0-h \leq z \leq \delta_b -h
\end{equation}\]</div>
<p>and the drag coefficient is calculated from Eq. 7, 8, and 11 as - </p>
<div class="arithmatex">\[\begin{equation}
C_D = \left( \frac{1}{\kappa_0} ln(\delta_b/z_0) \right) ^{-2}
\end{equation}\]</div>
<p>which is the drag formula as discussed in <a href="#blumberg1987">Blumberg and Mellor (1987)</a>. Eq. 11 also shows that the vertical viscosity term in the momentum equation vanishes inside the boundary layer. This fact will be utilized in the numerical formulation.</p>
<h2 id="turbulence-closure">Turbulence closure<a class="headerlink" href="#turbulence-closure" title="Permanent link">&para;</a></h2>
<p>Eq 1-4 are not closed and must be supplemented by turbulence closure equations for the viscosity/diffusivity. We use the Generic Length-scale (GLS) model of <a href="#umlauf2003">Umlauf and Burchard (2003)</a>, which has the advantage of encompassing most of the Eq 6 closure models <span class="arithmatex">\(k-\varepsilon\)</span> (<a href="#rodi1984">Rodi 1984</a>); <span class="arithmatex">\(k-\omega\)</span> (<a href="#wilcox1998">Wilcox 1998</a>; <a href="#mellor1982">Mellor and Yamada, 1982</a>). In this framework, the transport, production, and dissipation of the turbulent kinetic energy (<span class="arithmatex">\(K\)</span>) and of a generic length-scale variable (<span class="arithmatex">\(\psi\)</span>) are governed by - </p>
<div class="arithmatex">\[\begin{equation}
\frac{Dk}{Dt} = \frac{\partial}{\partial z} \left( \nu_k^{\psi} \frac{\partial k}{\partial z} \right) + \nu M^2 + \kappa N^2 - \varepsilon + c_{fk} \alpha \left| \pmb{u} \right|^3 \mathcal{H} (z_v - z)
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\frac{D \psi}{Dt} = \frac{\partial}{\partial z} \left( \nu_{\psi} \frac{\partial \psi}{\partial z} \right) + \frac{\psi}{k}\left[ c_{\psi 1} \nu M^2 + c_{\psi 3} \kappa N^2 - c_{\psi 2}\varepsilon F_{wall} + c_{f\psi} \alpha \left| \pmb{u} \right|^3 \mathcal{H}(z_v-z) \right]
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\nu_k^{\psi}\)</span> and <span class="arithmatex">\(\nu_{\psi}\)</span> are vertical turbulent diffusivities, <span class="arithmatex">\(c_{\psi 1}\)</span>, <span class="arithmatex">\(c_{\psi 2}\)</span>, and <span class="arithmatex">\(c_{\psi 3}\)</span> are model-specific constants (<a href="#umlauf2003">Umlauf and Burchard 2003</a>), <span class="arithmatex">\(F_{wall}\)</span> is a wall proximity function, <span class="arithmatex">\(M\)</span> and <span class="arithmatex">\(N\)</span> are shear and buoyancy frequencies, and <span class="arithmatex">\(\varepsilon\)</span> is a dissipation rate. The generic length-scale is defined as - </p>
<div class="arithmatex">\[\begin{equation}
\psi = (c_{\mu}^0)^p K^m \ell^n
\end{equation}\]</div>
<p>where <span class="arithmatex">\(c_{\mu}^0 = 0.3^{1/2}\)</span> and <span class="arithmatex">\(\ell\)</span> is the turbulence mixing length. The specific choices of the constants <span class="arithmatex">\(p\)</span>, <span class="arithmatex">\(m\)</span>, and <span class="arithmatex">\(n\)</span> lead to the different closure models mentioned above. Finally, vertical viscosities and diffusivities as appeared in Eq 1-4 are related to <span class="arithmatex">\(K\)</span>, <span class="arithmatex">\(ell\)</span>, and stability functions - </p>
<div class="arithmatex">\[\begin{equation}
\begin{aligned}
\nu = \sqrt{2} s_m K^{1/2} \ell \\
\kappa = \sqrt{2} s_h K^{1/2} \ell \\
\nu_k^{\psi} = \frac{\nu}{\sigma_k^{\psi}} \\
\nu_{\psi} = \frac{\nu}{\sigma_{\psi}}
\end{aligned}
\end{equation}\]</div>
<p>where the Schmidt numbers <span class="arithmatex">\(\sigma_k^{\psi}\)</span> and <span class="arithmatex">\(\sigma_{\psi}\)</span> are model-specific constants. The stability functions (<span class="arithmatex">\(s_m\)</span> and <span class="arithmatex">\(s_h\)</span>) are given by an Algebraic Stress Model (e.g.: <a href="#kantha1994">Kantha and Clayson 1994</a>, <a href="#canuto2001">Canuto et al. 2001</a>, or <a href="#galperin1988">Galperin et al. 1988</a>). Following <a href="#">Shimizu and Tsujimoto (1994; ST94 hereafter)</a>, we set <span class="arithmatex">\(c_{fk} = 0.07\)</span> and <span class="arithmatex">\(c_{f\psi} = 0.16\)</span>.</p>
<p>At the free surface and at the bottom of rivers and oceans, the turbulent kinetic energy and the mixing length are specified as Direchlet boundary conditions - </p>
<div class="arithmatex">\[\begin{equation}
K = \frac{1}{2} B_1^{2/3} \left| \pmb{\tau_b} \right|, \text{ or } \frac{1}{2} B_1^{2/3} \left| \pmb{\tau_w} \right| 
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\ell = \kappa_o d_b \text{ or } \kappa_0 d_s
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\pmb{\tau_b}\)</span> is a bottom frictional stress, <span class="arithmatex">\(\kappa_0 = 0.4\)</span> is the von Karman’s constant, <span class="arithmatex">\(B_1\)</span> is a constant, and <span class="arithmatex">\(d_b\)</span> and <span class="arithmatex">\(d_s\)</span> are the distances to the bottom and the free surface, respectively.</p>
<h2 id="air-sea-exchange">Air-sea exchange<a class="headerlink" href="#air-sea-exchange" title="Permanent link">&para;</a></h2>
<p>We use the bulk aerodynamic module of <a href="#zeng1998">Zeng et al. (1998)</a>, which can be viewed <a href="http://ccrm.vims.edu/yinglong/SVN_large_files/Zeng_etal_JClimate_1998-BulkAerodynamic-Model.pdf">here</a>.</p>
<p><strong>References</strong></p>
<p><span id="blumberg1987">Blumberg, A.F. and G.L. Mellor (1987) A description of a three-dimensional coastal ocean circulation model. In: Three-Dimensional Coastal Ocean Models, vol. 4, Coastal and Estuarine Studies, N. Heaps, editor, Washington, D.C.: AGU, pp. 1-16.</span></p>
<p><span id="canuto2001">Canuto, V.M., A. Howard, Y. Cheng and M.S. Dubovikov (2001) Ocean turbulence I: one-point closure model. Momentum and heat vertical diffusivities. J. Phys. Oceano., 31, pp. 1413-1426.</span></p>
<p><span id="galperin1988">Galperin, B., L. H. Kantha, S. Hassid and A. Rosati (1988) A quasi-equilibrium turbulent energy model for geophysical flows. J. Atmos. Sci., 45, pp. 55-62.</span></p>
<p><span id="kantha1994">Kantha, L.H. and C.A. Clayson (1994) An improved mixed layer model for geophysical applications. J. Geophy. Res, 99(25), pp. 235-266.</span></p>
<p><span id="mellor1982">Mellor, G.L. and T. Yamada (1982) Development of a turbulence closure model for geophysical fluid problems. Rev. Geophys., 20, pp. 851-875.</span></p>
<p><span id="pond1998">Pond, S. and G.L. Pickard (1998) Introductory Dynamical Oceanography, Butterworth-Heinmann.</span></p>
<p><span id="rodi1984">Rodi, W. (1984) Turbulence models and their applications in hydraulics: a state of the art review. Delft, The Netherlands, International Association for Hydraulics Research.</span></p>
<p><span id="umlauf2003">Umlauf, L. and H. Burchard (2003) A generic length-scale equation for geophysical turbulence models. J. Mar. Res., 6, pp. 235-265.</span></p>
<p><span id="wilcox1998">Wilcox, D.C. (1998) Reassessment of scale determining equation for advance turbulence models. AIAA J., 26, pp. 1299-1310.</span></p>
<p><span id="zeng1998">Zeng, X., M. Zhao and R.E. Dickinson (1998) Intercomparison of bulk aerodynamic algorithms for the computation of sea surface fluxes using TOGA COARE and TAO data. J. Clim., 11, pp. 2628-2644.</span></p>
<p><span id="zhang2016">Zhang, Y., Ye, F., Stanev, E.V., Grashorn, S. (2016). Seamless cross-scale modeling with SCHISM, Ocean Modelling, 102, 64-81. doi:10.1016/j.ocemod.2016.05.002</span></p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../getting-started/post-processing.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Postprocessing" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Postprocessing
            </div>
          </div>
        </a>
      
      
        
        <a href="geometry-discretization.html" class="md-footer__link md-footer__link--next" aria-label="Next: Geometry and discretization" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Geometry and discretization
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "toc.follow", "content.code.annotate"], "search": "../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f758a944.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>